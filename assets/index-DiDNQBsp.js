(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=o(i);fetch(i.href,n)}})();function $(t){return typeof window<"u"&&window.location.hostname==="itsecretary-map.github.io"?`/chromecast_stream/images/slideshow/${t}`:`./images/slideshow/${t}`}const M=[{ar:"ÿ•ŸêŸÜŸéŸë ÿßŸÑÿµŸéŸëŸÑŸéÿßÿ©Ÿé ÿ™ŸéŸÜŸíŸáŸéŸâŸ∞ ÿπŸéŸÜŸê ÿßŸÑŸíŸÅŸéÿ≠Ÿíÿ¥Ÿéÿßÿ°Ÿê ŸàŸéÿßŸÑŸíŸÖŸèŸÜŸÉŸéÿ±Ÿê",en:"Indeed, prayer prohibits immorality and wrongdoing. (Quran 29:45)"},{ar:"ÿÆŸéŸäŸíÿ±ŸèŸÉŸèŸÖŸí ÿ£Ÿéÿ≠Ÿíÿ≥ŸéŸÜŸèŸÉŸèŸÖŸí ÿ£ŸéÿÆŸíŸÑŸéÿßŸÇŸãÿß",en:"The best among you are those who have the best manners and character. (Bukhari)"},{ar:"ŸÅŸéÿßÿ∞ŸíŸÉŸèÿ±ŸèŸàŸÜŸêŸä ÿ£Ÿéÿ∞ŸíŸÉŸèÿ±ŸíŸÉŸèŸÖŸí",en:"So remember Me; I will remember you. (Quran 2:152)"},{ar:"ŸÖŸéŸÜŸí ŸÑŸéÿß ŸäŸéÿ¥ŸíŸÉŸèÿ±Ÿê ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé ŸÑŸéÿß ŸäŸéÿ¥ŸíŸÉŸèÿ±Ÿê ÿßŸÑŸÑŸéŸëŸáŸé",en:"Whoever does not thank people has not thanked Allah. (Tirmidhi)"},{ar:"ŸàŸéŸàŸéÿ¨ŸéÿØŸéŸÉŸé ÿ∂ŸéÿßŸÑŸãŸëÿß ŸÅŸéŸáŸéÿØŸéŸâŸ∞",en:"And He found you lost and guided [you]. (Quran 93:7)"},{ar:"ŸÑŸéŸäŸíÿ≥Ÿé ÿßŸÑÿ¥ŸéŸëÿØŸêŸäÿØŸè ÿ®ŸêÿßŸÑÿµŸèŸëÿ±ŸéÿπŸéÿ©Ÿêÿå ÿ•ŸêŸÜŸéŸëŸÖŸéÿß ÿßŸÑÿ¥ŸéŸëÿØŸêŸäÿØŸè ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéŸÖŸíŸÑŸêŸÉŸè ŸÜŸéŸÅŸíÿ≥ŸéŸáŸè ÿπŸêŸÜÿØŸé ÿßŸÑŸíÿ∫Ÿéÿ∂Ÿéÿ®Ÿê",en:"The strong man is not the one who can overpower others. The strong man is the one who controls himself when angry. (Bukhari)"},{ar:"ŸàŸéŸÑŸéÿ≥ŸéŸàŸíŸÅŸé ŸäŸèÿπŸíÿ∑ŸêŸäŸÉŸé ÿ±Ÿéÿ®ŸèŸëŸÉŸé ŸÅŸéÿ™Ÿéÿ±Ÿíÿ∂ŸéŸâŸ∞",en:"And your Lord is going to give you, and you will be satisfied. (Quran 93:5)"},{ar:"ŸäŸéÿ≥ŸêŸëÿ±ŸèŸàÿß ŸàŸéŸÑŸéÿß ÿ™ŸèÿπŸéÿ≥ŸêŸëÿ±ŸèŸàÿß",en:"Make things easy and do not make them difficult. (Bukhari)"},{ar:"ŸàŸéŸÖŸéŸÜ ŸäŸéÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸí ÿπŸéŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê ŸÅŸéŸáŸèŸàŸé ÿ≠Ÿéÿ≥Ÿíÿ®ŸèŸáŸè",en:"And whoever puts his trust in Allah, then He will suffice him. (Quran 65:3)"},{ar:"ŸÑŸéÿß ŸäŸèÿ§ŸíŸÖŸêŸÜŸè ÿ£Ÿéÿ≠ŸéÿØŸèŸÉŸèŸÖŸí ÿ≠Ÿéÿ™ŸéŸëŸâ ŸäŸèÿ≠Ÿêÿ®ŸéŸë ŸÑÿ£ŸéÿÆŸêŸäŸáŸê ŸÖŸéÿß ŸäŸèÿ≠Ÿêÿ®ŸèŸë ŸÑŸêŸÜŸéŸÅŸíÿ≥ŸêŸáŸê",en:"None of you truly believes until he loves for his brother what he loves for himself. (Bukhari & Muslim)"}];function F(){const t=typeof window<"u"&&(window.location.hostname==="itsecretary-map.github.io"||window.location.pathname.includes("/chromecast_stream/")||window.location.href.includes("github.io"));return console.log("üîç GitHub Pages detection:",{hostname:window.location.hostname,pathname:window.location.pathname,href:window.location.href,isGitHubPages:t}),t?{mapWebsite:"/chromecast_stream/images/qr-codes/mapitt.png",communityWhatsApp:"/chromecast_stream/images/qr-codes/whatsapp_group.png"}:{mapWebsite:"./images/qr-codes/mapitt.png",communityWhatsApp:"./images/qr-codes/whatsapp_group.png"}}const A={mapWebsite:"MAP Website",communityWhatsApp:"WhatsApp"},I={owner:"itsecretary-map",repo:"chromecast_stream",folder:"images/slideshow",enabled:!0};function H(){const t=window.location.hostname==="itsecretary-map.github.io"||window.location.pathname.includes("/chromecast_stream/"),e=["./CCA_5344-HDR.jpg","CCA_5344-HDR.jpg","/CCA_5344-HDR.jpg","../CCA_5344-HDR.jpg"];t&&(e.unshift("/chromecast_stream/CCA_5344-HDR.jpg"),e.unshift("./chromecast_stream/CCA_5344-HDR.jpg")),console.log("üñºÔ∏è  Attempting to load background image from multiple paths:",e),console.log("üìç Current page URL:",window.location.href),console.log("üìÅ Current page pathname:",window.location.pathname);let o=0;const s=new Image;s.onload=()=>{console.log("‚úÖ Background image loaded successfully:",s.src),console.log("üìè Image dimensions:",s.naturalWidth,"x",s.naturalHeight),console.log("üíæ Image size:",(s.naturalWidth*s.naturalHeight*4/1024/1024).toFixed(2),"MB (estimated)"),document.body.style.setProperty("background-image",`url('${s.src}')`,"important"),document.body.style.setProperty("background-size","cover","important"),document.body.style.setProperty("background-position","center center","important"),document.body.style.setProperty("background-attachment","fixed","important"),document.body.style.setProperty("background-repeat","no-repeat","important"),console.log("üé® Background image applied to body element with !important")},s.onerror=()=>{if(console.error(`‚ùå Failed to load background image from path ${o+1}/${e.length}:`,e[o]),o++,o<e.length){const i=e[o];console.log(`üîÑ Trying next path (${o+1}/${e.length}):`,i),s.src=i}else console.error("‚ùå All paths failed. Background image could not be loaded."),console.log("üé® Keeping CSS gradient background as fallback")},console.log(`üöÄ Starting with path: ${e[0]}`),s.src=e[0],fetch(e[0]).then(i=>{i.ok?console.log("‚úÖ Fetch API confirms image is accessible:",e[0]):console.error("‚ùå Fetch API failed:",i.status,i.statusText)}).catch(i=>{console.error("‚ùå Fetch API error:",i)})}let l=[];const b="github_images_cache",S=1440*60*1e3;async function Q(){try{const t=localStorage.getItem(b);if(t){const o=JSON.parse(t),s=Date.now();if(s-o.timestamp<S)return console.log("üì¶ Using cached GitHub images (age:",Math.round((s-o.timestamp)/1e3/60),"minutes)"),o.images;console.log("‚è∞ Cache expired, fetching fresh images from GitHub")}const e=await T();if(e.length>0){const o={images:e,timestamp:Date.now()};localStorage.setItem(b,JSON.stringify(o)),console.log("üíæ Cached fresh GitHub images")}return e}catch(t){console.error("‚ùå Error in cache management:",t);const e=localStorage.getItem(b);if(e){const o=JSON.parse(e);return console.log("üîÑ Using expired cache as fallback"),o.images}return[]}}async function T(){try{const t=`https://api.github.com/repos/${I.owner}/${I.repo}/contents/${I.folder}`;console.log("Fetching images from GitHub:",t);const e=await fetch(t);if(!e.ok){if(e.status===404)return console.warn("‚ö†Ô∏è GitHub folder not found:",t),console.log("This is expected if the folder is empty or doesn't exist"),[];throw new Error(`GitHub API error: ${e.status} ${e.statusText}`)}const o=await e.json();console.log("GitHub API response:",o),console.log("üìÅ All files returned from GitHub:",o.map(n=>n.name));const s=o.filter(n=>{const a=n.name.toLowerCase().split(".").pop(),r=["jpg","jpeg","png","gif","webp"].includes(a),h=!n.name.includes("CCA_5344-HDR");return console.log(`üîç File: ${n.name}, isImage: ${r}, isNotBackground: ${h}`),r&&h});console.log(`‚úÖ Found ${s.length} valid slideshow image files:`,s);const i=s.map(n=>({id:n.sha,name:n.name,url:n.download_url}));return console.log("GitHub images processed:",i),i}catch(t){return console.error("Error fetching GitHub images:",t),console.log("Falling back to default slideshow images"),[]}}function L(){localStorage.removeItem(b),console.log("üóëÔ∏è Image cache cleared")}function G(){if(window.location.hostname==="localhost"||window.location.hostname.includes("github.io")||window.innerWidth>=1920||window.innerHeight>=1080){console.log("üì∫ Chromecast Receiver Mode Detected"),console.log("  - Screen size:",window.innerWidth,"x",window.innerHeight),console.log("  - Hostname:",window.location.hostname),W();const e=document.querySelector(".chromecast-controls");e&&(e.style.display="none",console.log("üéØ Hidden Chromecast sender controls for receiver mode"))}else console.log("üíª Sender Mode Detected (showing cast controls)")}function W(){const t=document.body;t.style.fontSize=window.innerWidth>=3840?"32px":"24px";const e=document.querySelector(".slideshow img");e&&(e.style.borderRadius="16px",e.style.boxShadow="0 8px 32px rgba(0, 0, 0, 0.6)"),console.log("üé® TV display optimizations applied (CSS-preserving)")}function _(){const t=window.innerWidth/window.innerHeight;window.innerWidth>=1920&&(console.log(`TV detected: ${window.innerWidth}x${window.innerHeight}, aspect ratio: ${t.toFixed(2)}`),t<=16/9?(document.documentElement.style.setProperty("--min-height","clamp(30vh, 40vh, 45vh)"),document.documentElement.style.setProperty("--header-height","clamp(7.2vh, 10.8vh, 13.5vh)"),document.documentElement.style.setProperty("--announcements-height","clamp(7.2vh, 10.8vh, 13.5vh)"),document.documentElement.style.setProperty("--column-gap","clamp(20px, 2.5vw, 35px)"),document.documentElement.style.setProperty("--row-gap","clamp(4px, 0.5vw, 8px)"),console.log("Applied 16:9 TV optimization (CSS-aligned)")):(document.documentElement.style.setProperty("--min-height","clamp(25vh, 35vh, 40vh)"),document.documentElement.style.setProperty("--header-height","clamp(5.4vh, 9vh, 10.8vh)"),document.documentElement.style.setProperty("--announcements-height","clamp(5.4vh, 9vh, 10.8vh)"),document.documentElement.style.setProperty("--column-gap","clamp(25px, 3vw, 45px)"),document.documentElement.style.setProperty("--row-gap","clamp(3px, 0.4vw, 6px)"),console.log("Applied ultra-wide TV optimization (CSS-aligned)")))}window.addEventListener("load",_);window.addEventListener("resize",_);let m=0;const g=document.getElementById("slideshow-img");let P=0;function u(t){if(l.length===0){console.log("No images available to show");return}console.log(`Showing image ${t+1} of ${l.length}:`,l[t]),g.style.opacity=0;let e=document.getElementById("slideshow-error");e&&e.remove(),setTimeout(()=>{const o=l[t];console.log("Setting image src to:",o),g.src=o,g.onload=()=>{console.log("Image loaded successfully:",o),g.style.opacity=1},g.onerror=()=>{if(console.error("Image failed to load:",o),g.style.opacity=.2,!document.getElementById("slideshow-error")){const s=document.createElement("div");s.id="slideshow-error",s.style.color="red",s.style.textAlign="center",s.style.marginTop="10px",s.textContent="Image failed to load. Check the image URL or try another image.",g.parentNode.appendChild(s)}}},300)}function B(){l.length!==0&&(m===l.length-1&&(P++,console.log(`üîÑ Completed rotation ${P} through ${l.length} images`),z()),m=(m+1)%l.length,u(m))}async function z(){console.log("üîÑ Refreshing slideshow images after completing rotation...");try{L();const t=await T();if(t.length>0){const e=l.length;l=t.map(o=>o.url),console.log(`‚úÖ Refreshed slideshow: ${e} ‚Üí ${l.length} images`),m=0,u(m),l.length>e&&console.log(`üéâ Found ${l.length-e} new images!`)}else console.log("‚ö†Ô∏è No fresh images found, keeping current set")}catch(t){console.error("‚ùå Error refreshing images after rotation:",t),console.log("üîÑ Continuing with current image set")}}async function O(){try{console.log("Initializing slideshow with GitHub images..."),L();const t=await Q();t.length>0?(l=t.map(e=>e.url),console.log(`Updated slideshow with ${l.length} images from GitHub`),l.length>0&&(m=0,u(m))):(console.log("No images found in GitHub repository"),l=E(),l.length>0&&(m=0,u(m)))}catch(t){console.error("Error initializing slideshow:",t),l=E(),l.length>0&&(m=0,u(m))}}setInterval(B,1e4);function E(){return[$("imam_schedule.jpg"),$("sundayschool.jpg")]}const R=document.getElementById("announcements-list");let C=0;function k(t){R.innerHTML="";const e=document.createElement("div"),o=M[t].en.replace(/[.]+(?=\s*\()/,"");e.innerHTML=`<div style="font-size:1rem;text-align:center;color:white;line-height:1.4;padding:15px;background:rgba(255,255,255,0.1);border-radius:8px;border-left:4px solid #2196F3;">${o}</div>`,R.appendChild(e)}k(C);setInterval(()=>{C=(C+1)%M.length,k(C)},2e4);const j="15044",q="US",y=document.getElementById("prayer-times-list");fetch(`https://api.aladhan.com/v1/timingsByAddress?address=${j},${q}`).then(t=>t.json()).then(t=>{const e=t.data.timings;["Fajr","Dhuhr","Asr","Maghrib","Isha"].forEach(i=>{let n=e[i];if(n){let[r,h]=n.split(":"),c=parseInt(r,10),p="AM";c===0?c=12:c===12?p="PM":c>12&&(c-=12,p="PM"),n=`${c}:${h} ${p}`}const a=document.createElement("li");a.textContent=`${i}: ${n}`,y.appendChild(a)});const s=document.createElement("li");s.textContent="Jummah: 1:15 PM",y.appendChild(s)}).catch(()=>{[{name:"Fajr",time:"05:12 AM"},{name:"Dhuhr",time:"01:23 PM"},{name:"Asr",time:"05:07 PM"},{name:"Maghrib",time:"08:34 PM"},{name:"Isha",time:"10:02 PM"}].forEach(o=>{let[s,i,n]=o.time.match(/(\d+):(\d+)\s*(AM|PM)/i)||[],a=o.time;s&&i&&n&&(a=`${parseInt(s,10)}:${i} ${n.toUpperCase()}`);const r=document.createElement("li");r.textContent=`${o.name}: ${a}`,y.appendChild(r)});const e=document.createElement("li");e.textContent="Jummah: 1:15 PM",y.appendChild(e)});function v(){console.log("üîç Rendering QR codes...");const t=document.querySelector(".qr-list");if(console.log("üìç QR list element:",t),t){const e=F();console.log("üñºÔ∏è QR image URLs:",e),e&&typeof e=="object"?(t.innerHTML="",Object.entries(e).forEach(([o,s],i)=>{console.log(`üì± Creating QR code ${i+1}:`,o,s);const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="center",n.style.marginBottom="18px";const a=document.createElement("div");a.textContent=A[o]||o.replace(/([A-Z])/g," $1").replace(/^./,c=>c.toUpperCase()),a.style.color="#ffd600",a.style.fontSize="1.1rem",a.style.marginBottom="8px",a.style.textAlign="center",a.style.wordBreak="break-word";const r=document.createElement("img");r.className="qr-img",r.alt=a.textContent,(c=>{const f=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?[`./images/qr-codes/${c==="mapWebsite"?"mapitt.png":"whatsapp_group.png"}`,`images/qr-codes/${c==="mapWebsite"?"mapitt.png":"whatsapp_group.png"}`]:[`/chromecast_stream/images/qr-codes/${c==="mapWebsite"?"mapitt.png":"whatsapp_group.png"}`,`./images/qr-codes/${c==="mapWebsite"?"mapitt.png":"whatsapp_group.png"}`];f.unshift(s);let w=0;const x=()=>{if(w<f.length){const d=f[w];console.log(`üîÑ Trying QR image path ${w+1}/${f.length}:`,d),r.src=d,w++}else{console.error(`‚ùå All paths failed for QR image: ${c}`);const d=document.createElement("div");d.textContent=`QR Code: ${A[o]||o}`,d.style.color="#ff6b6b",d.style.fontSize="0.8rem",d.style.textAlign="center",d.style.marginTop="5px",n.appendChild(d)}};r.onerror=()=>{console.error("‚ùå Failed to load QR image from path:",r.src),x()},r.onload=()=>{console.log(`‚úÖ QR image loaded successfully: ${r.src}`),console.log("‚úÖ Image element:",r),console.log("‚úÖ Image dimensions:",r.naturalWidth,"x",r.naturalHeight)},x()})(o),console.log(`üì∏ Created image element for ${o}:`,r),console.log("üîó Image src set to:",s),n.appendChild(a),n.appendChild(r),t.appendChild(n)}),console.log("‚úÖ QR codes rendered successfully"),console.log("üîç Final QR list HTML:",t.innerHTML),console.log("üîç QR list children count:",t.children.length),console.log("üîç All image elements in QR list:",t.querySelectorAll("img")),t.children.length===0&&(console.warn("‚ö†Ô∏è No QR codes rendered, retrying in 1 second..."),setTimeout(()=>{console.log("üîÑ Retrying QR code rendering..."),v()},1e3))):console.error("‚ùå QR image URLs not available or invalid")}else console.error("‚ùå QR list element not found")}console.log("üöÄ Initializing Chromecast Receiver Demo...");document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{console.log("üìÑ DOM fully loaded, setting background image..."),H(),setTimeout(()=>{v()},100)}):(console.log("üìÑ DOM already loaded, setting background image..."),H(),setTimeout(()=>{v()},100));O();G();function D(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),o=e-t;console.log("üïõ Scheduling daily reload at midnight"),console.log("‚è∞ Current time:",t.toLocaleTimeString()),console.log("üåÖ Next reload at:",e.toLocaleString()),console.log("‚è≥ Time until reload:",Math.round(o/1e3/60),"minutes"),setTimeout(()=>{console.log("üîÑ Executing scheduled daily reload..."),window.location.reload()},o),setTimeout(()=>{D()},o)}D();console.log("üîß Cache Management Commands Available:");console.log("  - getCacheInfo() - Check cache status");console.log("  - clearImageCache() - Clear image cache");console.log("  - forceRefreshImages() - Force refresh from GitHub");console.log("  - CACHE_DURATION:",Math.round(S/1e3/60),"minutes");console.log("‚úÖ Initialization complete!");
